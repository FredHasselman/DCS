<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A Complex Systems Approach to Study Human Nature</title>
  <meta name="description" content="Complexity Workshop Köln: 12-05-2017">
  <meta name="generator" content="bookdown 0.3.9 and GitBook 2.6.7">

  <meta property="og:title" content="A Complex Systems Approach to Study Human Nature" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://fredhasselman.com/htmlHost/DCSKOELN/" />
  <meta property="og:image" content="http://fredhasselman.com/htmlHost/DCSKOELN/images/foundations.png" />
  <meta property="og:description" content="Complexity Workshop Köln: 12-05-2017" />
  <meta name="github-repo" content="FredHasselman/DCS/Reader1617" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Complex Systems Approach to Study Human Nature" />
  
  <meta name="twitter:description" content="Complexity Workshop Köln: 12-05-2017" />
  <meta name="twitter:image" content="http://fredhasselman.com/htmlHost/DCSKOELN/images/foundations.png" />

<meta name="author" content="Fred Hasselman">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="pacfsol.html">
<link rel="next" href="phase-space-reconstruction-and-recurrence-quantification-analysis-rqa.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.4/dygraphs.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Dynamics of Complex Systems</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> <strong>An introduction to the analytical toolbox of Complexity Science</strong></a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#tentative-program"><i class="fa fa-check"></i>Tentative program</a></li>
<li><a href="using-r.html#using-r">Using <code>R</code>!</a><ul>
<li class="chapter" data-level="" data-path="using-r.html"><a href="using-r.html"><i class="fa fa-check"></i>Packages needed for the assignments</a></li>
<li class="chapter" data-level="" data-path="using-r.html"><a href="using-r.html#files-on-github"><i class="fa fa-check"></i>Files on GitHub</a></li>
<li class="chapter" data-level="1.0.1" data-path="using-r.html"><a href="using-r.html#timeseries-in-r"><i class="fa fa-check"></i><b>1.0.1</b> Timeseries in <code class="unnumbered">R</code></a></li>
<li class="chapter" data-level="" data-path="using-r.html"><a href="using-r.html#this-document"><i class="fa fa-check"></i>This document</a></li>
</ul></li>
</ul></li>
<li><a href="assignments-how-to.html#assignments-how-to"><strong>Assignments: How to … </strong></a><ul>
<li class="chapter" data-level="" data-path="assignments-how-to.html"><a href="assignments-how-to.html"><i class="fa fa-check"></i>General Guidelines</a></li>
</ul></li>
<li class="part"><span><b>I Introduction to the mathematics of change</b></span></li>
<li class="chapter" data-level="2" data-path="moc1ass.html"><a href="moc1ass.html"><i class="fa fa-check"></i><b>2</b> <strong>Modelling (nonlinear) growth</strong></a><ul>
<li class="chapter" data-level="2.1" data-path="the-linear-map-in-a-spreadsheet.html"><a href="the-linear-map-in-a-spreadsheet.html"><i class="fa fa-check"></i><b>2.1</b> The Linear Map in a Spreadsheet</a><ul>
<li class="chapter" data-level="" data-path="the-linear-map-in-a-spreadsheet.html"><a href="the-linear-map-in-a-spreadsheet.html#the-control-parameter"><i class="fa fa-check"></i>The control parameter</a></li>
<li class="chapter" data-level="" data-path="the-linear-map-in-a-spreadsheet.html"><a href="the-linear-map-in-a-spreadsheet.html#dependence-on-initial-conditions"><i class="fa fa-check"></i>Dependence on initial conditions?</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="the-logistic-map-in-a-spreadsheet.html"><a href="the-logistic-map-in-a-spreadsheet.html"><i class="fa fa-check"></i><b>2.2</b> The Logistic Map in a spreadsheet</a><ul>
<li class="chapter" data-level="" data-path="the-logistic-map-in-a-spreadsheet.html"><a href="the-logistic-map-in-a-spreadsheet.html#the-control-parameter-1"><i class="fa fa-check"></i>The control parameter</a></li>
<li class="chapter" data-level="" data-path="the-logistic-map-in-a-spreadsheet.html"><a href="the-logistic-map-in-a-spreadsheet.html#the-return-plot"><i class="fa fa-check"></i>The return plot</a></li>
<li class="chapter" data-level="2.2.1" data-path="the-logistic-map-in-a-spreadsheet.html"><a href="the-logistic-map-in-a-spreadsheet.html#sensitive-dependence-on-initial-conditions"><i class="fa fa-check"></i><b>2.2.1</b> Sensitive dependence on initial conditions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="moc1R.html"><a href="moc1R.html"><i class="fa fa-check"></i><b>2.3</b> Using <code>R</code> or <code>Matlab</code> to simulate these maps.</a><ul>
<li class="chapter" data-level="2.3.1" data-path="moc1R.html"><a href="moc1R.html#plot-the-timeseries"><i class="fa fa-check"></i><b>2.3.1</b> Plot the timeseries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="moc2ass.html"><a href="moc2ass.html"><i class="fa fa-check"></i><b>3</b> <strong>EXTRA</strong></a><ul>
<li class="chapter" data-level="" data-path="the-growth-model-by-van-geert-1991.html"><a href="the-growth-model-by-van-geert-1991.html"><i class="fa fa-check"></i>The growth model by Van Geert (1991)</a><ul>
<li class="chapter" data-level="3.0.1" data-path="the-growth-model-by-van-geert-1991.html"><a href="the-growth-model-by-van-geert-1991.html#the-growth-model-in-a-spreadsheet"><i class="fa fa-check"></i><b>3.0.1</b> The growth model in a spreadsheet</a></li>
</ul></li>
<li class="chapter" data-level="3.1" data-path="conditional-growth-jumps-and-stages.html"><a href="conditional-growth-jumps-and-stages.html"><i class="fa fa-check"></i><b>3.1</b> Conditional growth: Jumps and Stages</a><ul>
<li class="chapter" data-level="" data-path="conditional-growth-jumps-and-stages.html"><a href="conditional-growth-jumps-and-stages.html#auto-conditional-jumps"><i class="fa fa-check"></i>Auto-conditional jumps</a></li>
<li class="chapter" data-level="" data-path="conditional-growth-jumps-and-stages.html"><a href="conditional-growth-jumps-and-stages.html#auto-conditional-stages"><i class="fa fa-check"></i>Auto-conditional stages</a></li>
<li class="chapter" data-level="" data-path="conditional-growth-jumps-and-stages.html"><a href="conditional-growth-jumps-and-stages.html#connected-growers"><i class="fa fa-check"></i>Connected growers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="predator-prey-dynamics.html"><a href="predator-prey-dynamics.html"><i class="fa fa-check"></i><b>4</b> <strong>Predator-Prey dynamics</strong></a><ul>
<li class="chapter" data-level="4.1" data-path="predator-prey-model.html"><a href="predator-prey-model.html"><i class="fa fa-check"></i><b>4.1</b> Predator-prey model</a><ul>
<li class="chapter" data-level="4.1.1" data-path="predator-prey-model.html"><a href="predator-prey-model.html#euler-method"><i class="fa fa-check"></i><b>4.1.1</b> Euler Method</a></li>
<li class="chapter" data-level="4.1.2" data-path="predator-prey-model.html"><a href="predator-prey-model.html#coupled-system-in-a-spreadsheet"><i class="fa fa-check"></i><b>4.1.2</b> Coupled System in a spreadsheet</a></li>
<li class="chapter" data-level="4.1.3" data-path="predator-prey-model.html"><a href="predator-prey-model.html#tip-of-the-iceberg"><i class="fa fa-check"></i><b>4.1.3</b> Tip of the iceberg</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-timeseries-analysis.html"><a href="basic-timeseries-analysis.html"><i class="fa fa-check"></i><b>5</b> <strong>Basic Timeseries Analysis</strong></a><ul>
<li class="chapter" data-level="5.1" data-path="time-series-analysis-in-spss-17-and-higher.html"><a href="time-series-analysis-in-spss-17-and-higher.html"><i class="fa fa-check"></i><b>5.1</b> Time series analysis in SPSS (17 and higher)</a><ul>
<li class="chapter" data-level="5.1.1" data-path="time-series-analysis-in-spss-17-and-higher.html"><a href="time-series-analysis-in-spss-17-and-higher.html#bta"><i class="fa fa-check"></i><b>5.1.1</b> Nonlinear Growth curves in SPSS</a></li>
<li class="chapter" data-level="5.1.2" data-path="time-series-analysis-in-spss-17-and-higher.html"><a href="time-series-analysis-in-spss-17-and-higher.html#pacf"><i class="fa fa-check"></i><b>5.1.2</b> Correlation functions and AR-MA models</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="notes-on-tsa-in-r.html"><a href="notes-on-tsa-in-r.html"><i class="fa fa-check"></i><b>5.2</b> Notes on TSA in <code id="bTSAinR">R</code></a><ul>
<li class="chapter" data-level="5.2.1" data-path="notes-on-tsa-in-r.html"><a href="notes-on-tsa-in-r.html#importing-data-in-r"><i class="fa fa-check"></i><b>5.2.1</b> Importing data in <code>R</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="part-ii-quantifying-recurrences-in-state-space.html"><a href="part-ii-quantifying-recurrences-in-state-space.html"><i class="fa fa-check"></i><b>6</b> (PART) II. Quantifying Recurrences in State Space</a></li>
<li class="chapter" data-level="7" data-path="phase-space-reconstruction-and-rqa.html"><a href="phase-space-reconstruction-and-rqa.html"><i class="fa fa-check"></i><b>7</b> <strong>Phase Space Reconstruction and RQA</strong></a><ul>
<li class="chapter" data-level="7.1" data-path="RQA.html"><a href="RQA.html"><i class="fa fa-check"></i><b>7.1</b> Reconstruct the Lorenz attractor</a></li>
<li class="chapter" data-level="7.2" data-path="reconstruct-the-predator-prey-model.html"><a href="reconstruct-the-predator-prey-model.html"><i class="fa fa-check"></i><b>7.2</b> Reconstruct the Predator-Prey model</a></li>
<li class="chapter" data-level="7.3" data-path="auto-recurrence-quantification-analysis.html"><a href="auto-recurrence-quantification-analysis.html"><i class="fa fa-check"></i><b>7.3</b> (auto-) Recurrence Quantification Analysis</a></li>
<li class="chapter" data-level="7.4" data-path="rqa-of-circle-tracing-data.html"><a href="rqa-of-circle-tracing-data.html"><i class="fa fa-check"></i><b>7.4</b> RQA of circle-tracing data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="categorical-and-cross-rqa-crqa.html"><a href="categorical-and-cross-rqa-crqa.html"><i class="fa fa-check"></i><b>8</b> <strong>Categorical and Cross-RQA (CRQA)</strong></a><ul>
<li class="chapter" data-level="8.1" data-path="CRQA.html"><a href="CRQA.html"><i class="fa fa-check"></i><b>8.1</b> Assignment: CRQA and Diagonal Profile</a></li>
<li class="chapter" data-level="8.2" data-path="catCRQA.html"><a href="catCRQA.html"><i class="fa fa-check"></i><b>8.2</b> Categorical CRQA</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cusp.html"><a href="cusp.html"><i class="fa fa-check"></i><b>9</b> Potential and Catastrophe Models</a><ul>
<li class="chapter" data-level="9.1" data-path="fitting-the-cusp-catastrophe-in-spss.html"><a href="fitting-the-cusp-catastrophe-in-spss.html"><i class="fa fa-check"></i><b>9.1</b> Fitting the cusp catastrophe in <code>SPSS</code></a></li>
<li class="chapter" data-level="9.2" data-path="the-cusp-package-in-r.html"><a href="the-cusp-package-in-r.html"><i class="fa fa-check"></i><b>9.2</b> The <code>cusp</code> package in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="nets.html"><a href="nets.html"><i class="fa fa-check"></i><b>10</b> <strong>Complex Networks</strong></a><ul>
<li class="chapter" data-level="10.1" data-path="basic-graphs.html"><a href="basic-graphs.html"><i class="fa fa-check"></i><b>10.1</b> Basic graphs</a></li>
<li class="chapter" data-level="10.2" data-path="social-networks.html"><a href="social-networks.html"><i class="fa fa-check"></i><b>10.2</b> Social Networks</a></li>
<li class="chapter" data-level="10.3" data-path="small-world-index-and-degree-distribution.html"><a href="small-world-index-and-degree-distribution.html"><i class="fa fa-check"></i><b>10.3</b> Small World Index and Degree Distribution</a></li>
<li class="chapter" data-level="10.4" data-path="package-qgraph.html"><a href="package-qgraph.html"><i class="fa fa-check"></i><b>10.4</b> Package <code>qgraph</code></a></li>
<li class="chapter" data-level="10.5" data-path="qgraph-tutorials-blog.html"><a href="qgraph-tutorials-blog.html"><i class="fa fa-check"></i><b>10.5</b> <code>qgraph</code> tutorials / blog</a></li>
<li class="chapter" data-level="10.6" data-path="extra-early-warnings.html"><a href="extra-early-warnings.html"><i class="fa fa-check"></i><b>10.6</b> EXTRA - early warnings</a></li>
</ul></li>
<li class="part"><span><b>II Notes</b></span></li>
<li class="chapter" data-level="" data-path="preparation-prep.html"><a href="preparation-prep.html"><i class="fa fa-check"></i>PREPARATION {#prep}</a><ul>
<li><a href="new-to-r.html#new-to-r">New to <code>R</code>?</a></li>
<li><a href="not-new-to-r.html#not-new-to-r">Not new to <code>R</code>?</a></li>
<li><a href="the-time-series-object-tsplot.html#the-time-series-object-tsplot">The <code>time series</code> object {#tsPlot}</a><ul>
<li><a href="the-time-series-object-tsplot.html#plotting-a-ts-object-as-a-time-series">Plotting a <code>ts</code> object as a time series</a></li>
<li class="chapter" data-level="" data-path="the-time-series-object-tsplot.html"><a href="the-time-series-object-tsplot.html"><i class="fa fa-check"></i>Plotting multiple time series in one figure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-i.html"><a href="part-i.html"><i class="fa fa-check"></i>PART I</a><ul>
<li class="chapter" data-level="" data-path="modelling-nonlinear-growth-and-deterministic-chaos.html"><a href="modelling-nonlinear-growth-and-deterministic-chaos.html"><i class="fa fa-check"></i>Modelling (nonlinear) growth and Deterministic Chaos</a><ul>
<li><a href="modelling-nonlinear-growth-and-deterministic-chaos.html#its-a-line-its-a-plane"><strong>It’s a line! It’s a plane!</strong></a></li>
<li><a href="modelling-nonlinear-growth-and-deterministic-chaos.html#no-its-a-time-series"><strong>No! … It’s a time series!</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="numerical-integration-to-simulate-continuous-time.html"><a href="numerical-integration-to-simulate-continuous-time.html"><i class="fa fa-check"></i>Numerical integration to simulate continuous time</a><ul>
<li class="chapter" data-level="" data-path="numerical-integration-to-simulate-continuous-time.html"><a href="numerical-integration-to-simulate-continuous-time.html#eulers-method-and-more"><i class="fa fa-check"></i>Euler’s method and more…</a></li>
<li class="chapter" data-level="" data-path="numerical-integration-to-simulate-continuous-time.html"><a href="numerical-integration-to-simulate-continuous-time.html#analytical-solution"><i class="fa fa-check"></i>Analytical solution</a></li>
<li class="chapter" data-level="" data-path="numerical-integration-to-simulate-continuous-time.html"><a href="numerical-integration-to-simulate-continuous-time.html#numerical-solution-discrete"><i class="fa fa-check"></i>Numerical solution (discrete)</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="advmodels.html"><a href="advmodels.html"><i class="fa fa-check"></i><b>10.7</b> Modeling interactions between processes and agents</a><ul>
<li class="chapter" data-level="" data-path="advmodels.html"><a href="advmodels.html#the-competetive-lottka-volterra-equations"><i class="fa fa-check"></i>The Competetive Lottka-Volterra Equations</a></li>
<li class="chapter" data-level="" data-path="advmodels.html"><a href="advmodels.html#predator-prey-and-other-dynamics-as-agent-based-models"><i class="fa fa-check"></i>Predator-Prey (and other) dynamics as Agent Based Models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-ii.html"><a href="part-ii.html"><i class="fa fa-check"></i>PART II</a><ul>
<li class="chapter" data-level="" data-path="part-ii.html"><a href="part-ii.html#using-r-install-functions-in-nlrtsa_source.r"><i class="fa fa-check"></i>Using R: Install functions in nlRtsa_SOURCE.R</a></li>
<li class="chapter" data-level="" data-path="examples-fast-fourier-transform-and-power-spectrum.html"><a href="examples-fast-fourier-transform-and-power-spectrum.html"><i class="fa fa-check"></i>Examples: Fast Fourier transform and Power Spectrum</a></li>
<li class="chapter" data-level="" data-path="data-considerations.html"><a href="data-considerations.html"><i class="fa fa-check"></i>Data considerations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="part-iii.html"><a href="part-iii.html"><i class="fa fa-check"></i>PART III</a><ul>
<li class="chapter" data-level="10.8" data-path="creating-fractals-from-random-processes.html"><a href="creating-fractals-from-random-processes.html"><i class="fa fa-check"></i><b>10.8</b> Creating fractals from random processes</a><ul>
<li class="chapter" data-level="" data-path="creating-fractals-from-random-processes.html"><a href="creating-fractals-from-random-processes.html#a-triangle"><i class="fa fa-check"></i>A Triangle</a></li>
<li class="chapter" data-level="" data-path="creating-fractals-from-random-processes.html"><a href="creating-fractals-from-random-processes.html#a-fern"><i class="fa fa-check"></i>A Fern</a></li>
<li class="chapter" data-level="" data-path="creating-fractals-from-random-processes.html"><a href="creating-fractals-from-random-processes.html#the-fractal-chaos-game"><i class="fa fa-check"></i>The fractal / chaos game</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="lecture-6.html"><a href="lecture-6.html"><i class="fa fa-check"></i>Lecture 6</a></li>
<li class="chapter" data-level="" data-path="lecture-7.html"><a href="lecture-7.html"><i class="fa fa-check"></i>Lecture 7</a></li>
<li class="chapter" data-level="" data-path="lecture-8.html"><a href="lecture-8.html"><i class="fa fa-check"></i>Lecture 8</a></li>
<li class="chapter" data-level="" data-path="lecture-9.html"><a href="lecture-9.html"><i class="fa fa-check"></i>Lecture 9</a></li>
<li class="appendix"><span><b>Solutions</b></span></li>
<li class="chapter" data-level="A" data-path="mathematics-of-change-i.html"><a href="mathematics-of-change-i.html"><i class="fa fa-check"></i><b>A</b> <strong>Mathematics of change I</strong></a><ul>
<li class="chapter" data-level="A.1" data-path="linear-and-logistic-growth.html"><a href="linear-and-logistic-growth.html"><i class="fa fa-check"></i><b>A.1</b> Linear and logistic growth</a><ul>
<li class="chapter" data-level="" data-path="linear-and-logistic-growth.html"><a href="linear-and-logistic-growth.html#solutions-in-a-spreadsheet"><i class="fa fa-check"></i>Solutions in a spreadsheet</a></li>
<li><a href="linear-and-logistic-growth.html#solutions-in-r">Solutions in <code id="moc1Rsol">R</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="extra.html"><a href="extra.html"><i class="fa fa-check"></i><b>B</b> <strong>EXTRA</strong></a><ul>
<li class="chapter" data-level="B.1" data-path="tvpar.html"><a href="tvpar.html"><i class="fa fa-check"></i><b>B.1</b> Time-varying parameters</a><ul>
<li class="chapter" data-level="" data-path="tvpar.html"><a href="tvpar.html#solutions-in-a-spreadsheet-1"><i class="fa fa-check"></i>Solutions in a spreadsheet</a></li>
<li class="chapter" data-level="B.1.1" data-path="tvpar.html"><a href="tvpar.html#solutions-in-r-1"><i class="fa fa-check"></i><b>B.1.1</b> Solutions in <code class="unnumbered">R</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="ppdsol.html"><a href="ppdsol.html"><i class="fa fa-check"></i><b>C</b> Predator-prey dynamics</a><ul>
<li class="chapter" data-level="" data-path="ppdsol.html"><a href="ppdsol.html#iterating-2d-maps-and-flows"><i class="fa fa-check"></i>Iterating 2D Maps and Flows</a></li>
<li class="chapter" data-level="" data-path="solutions-in-a-spreadsheet-2.html"><a href="solutions-in-a-spreadsheet-2.html"><i class="fa fa-check"></i>Solutions in a spreadsheet</a></li>
<li class="chapter" data-level="C.1" data-path="solutions-in-r-2.html"><a href="solutions-in-r-2.html"><i class="fa fa-check"></i><b>C.1</b> Solutions in <code class="unnumbered">R</code></a><ul>
<li class="chapter" data-level="" data-path="solutions-in-r-2.html"><a href="solutions-in-r-2.html#eulers-method-and-more-1"><i class="fa fa-check"></i>Euler’s method and more…</a></li>
<li class="chapter" data-level="" data-path="solutions-in-r-2.html"><a href="solutions-in-r-2.html#numerical-integration"><i class="fa fa-check"></i>Numerical integration</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="btasol.html"><a href="btasol.html"><i class="fa fa-check"></i><b>D</b> <strong>Basic Timeseries Analysis</strong></a><ul>
<li class="chapter" data-level="D.1" data-path="nonlinear-growth-curves-in-spss.html"><a href="nonlinear-growth-curves-in-spss.html"><i class="fa fa-check"></i><b>D.1</b> Nonlinear Growth curves in SPSS</a></li>
<li class="chapter" data-level="D.2" data-path="pacfsol.html"><a href="pacfsol.html"><i class="fa fa-check"></i><b>D.2</b> Correlation functions and AR-MA models</a></li>
<li class="chapter" data-level="D.3" data-path="using-r-to-fit-the-solutions.html"><a href="using-r-to-fit-the-solutions.html"><i class="fa fa-check"></i><b>D.3</b> Using <code>R</code> to fit the solutions</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="phase-space-reconstruction-and-recurrence-quantification-analysis-rqa.html"><a href="phase-space-reconstruction-and-recurrence-quantification-analysis-rqa.html"><i class="fa fa-check"></i><b>E</b> <strong>Phase Space Reconstruction and Recurrence Quantification Analysis (RQA)</strong></a><ul>
<li class="chapter" data-level="E.1" data-path="PSRsol.html"><a href="PSRsol.html"><i class="fa fa-check"></i><b>E.1</b> Phase Space Reconstruction of the Lorenz Attractor</a><ul>
<li class="chapter" data-level="" data-path="PSRsol.html"><a href="PSRsol.html#embedding-lag"><i class="fa fa-check"></i>Embedding Lag</a></li>
<li class="chapter" data-level="" data-path="PSRsol.html"><a href="PSRsol.html#false-nearest-neighbours"><i class="fa fa-check"></i>False Nearest Neighbours</a></li>
<li class="chapter" data-level="" data-path="PSRsol.html"><a href="PSRsol.html#plot-the-reconstructed-phase-space"><i class="fa fa-check"></i>Plot the reconstructed phase space</a></li>
</ul></li>
<li class="chapter" data-level="E.2" data-path="phase-space-reconstruction-of-the-predator-prey-system.html"><a href="phase-space-reconstruction-of-the-predator-prey-system.html"><i class="fa fa-check"></i><b>E.2</b> Phase Space Reconstruction of the Predator-Prey system</a><ul>
<li class="chapter" data-level="" data-path="phase-space-reconstruction-of-the-predator-prey-system.html"><a href="phase-space-reconstruction-of-the-predator-prey-system.html#embedding-lag-1"><i class="fa fa-check"></i>Embedding Lag</a></li>
<li class="chapter" data-level="" data-path="phase-space-reconstruction-of-the-predator-prey-system.html"><a href="phase-space-reconstruction-of-the-predator-prey-system.html#false-nearest-neighbours-1"><i class="fa fa-check"></i>False Nearest Neighbours</a></li>
<li class="chapter" data-level="" data-path="phase-space-reconstruction-of-the-predator-prey-system.html"><a href="phase-space-reconstruction-of-the-predator-prey-system.html#plot-the-reconstructed-phase-space-1"><i class="fa fa-check"></i>Plot the reconstructed phase space</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="recurrence-quantification-analysis.html"><a href="recurrence-quantification-analysis.html"><i class="fa fa-check"></i><b>F</b> <strong>Recurrence Quantification Analysis</strong></a><ul>
<li class="chapter" data-level="F.1" data-path="RQAsol.html"><a href="RQAsol.html"><i class="fa fa-check"></i><b>F.1</b> RQA of the Lorenz system</a></li>
<li class="chapter" data-level="F.2" data-path="rqa-of-the-circle-tracing-task.html"><a href="rqa-of-the-circle-tracing-task.html"><i class="fa fa-check"></i><b>F.2</b> RQA of the Circle Tracing Task</a><ul>
<li class="chapter" data-level="" data-path="rqa-of-the-circle-tracing-task.html"><a href="rqa-of-the-circle-tracing-task.html#embedding-lag-2"><i class="fa fa-check"></i>Embedding lag</a></li>
<li class="chapter" data-level="" data-path="rqa-of-the-circle-tracing-task.html"><a href="rqa-of-the-circle-tracing-task.html#false-nearest-neighbours-2"><i class="fa fa-check"></i>False Nearest Neighbours</a></li>
<li class="chapter" data-level="" data-path="rqa-of-the-circle-tracing-task.html"><a href="rqa-of-the-circle-tracing-task.html#run-the-rqa"><i class="fa fa-check"></i>Run the RQA</a></li>
</ul></li>
<li class="chapter" data-level="F.3" data-path="CRQAsol.html"><a href="CRQAsol.html"><i class="fa fa-check"></i><b>F.3</b> Assignment: Cross Recurrence Quantification Analysis</a></li>
<li class="chapter" data-level="F.4" data-path="catCRQAsol.html"><a href="catCRQAsol.html"><i class="fa fa-check"></i><b>F.4</b> Assignment: Categorical CRQA</a></li>
</ul></li>
<li class="chapter" data-level="G" data-path="netssol.html"><a href="netssol.html"><i class="fa fa-check"></i><b>G</b> <strong>Complex Networks</strong></a><ul>
<li class="chapter" data-level="G.1" data-path="basic-graphs-1.html"><a href="basic-graphs-1.html"><i class="fa fa-check"></i><b>G.1</b> Basic graphs</a></li>
<li class="chapter" data-level="G.2" data-path="social-networks-1.html"><a href="social-networks-1.html"><i class="fa fa-check"></i><b>G.2</b> Social Networks</a></li>
<li class="chapter" data-level="G.3" data-path="small-world-index-and-degree-distribution-1.html"><a href="small-world-index-and-degree-distribution-1.html"><i class="fa fa-check"></i><b>G.3</b> Small World Index and Degree Distribution</a></li>
</ul></li>
<li><a href="bibliography.html#bibliography"><strong>Bibliography</strong></a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Complex Systems Approach to Study Human Nature</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-r-to-fit-the-solutions" class="section level2">
<h2><span class="header-section-number">D.3</span> Using <code>R</code> to fit the solutions</h2>
<p>There are several packages that can perform nonlinear regression analysis, the function most resembling the approach used by <code>SPSS</code> is <code>nls</code> in the default <code>stats</code> package.</p>
<p>The easiest way to do this is to first define your function (i.e., the solution) and then fit it using starting values for the parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rio)
df &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://raw.githubusercontent.com/FredHasselman/DCS/master/assignmentData/BasicTSA_nonlinreg/GrowthRegression.sav&quot;</span>, <span class="dt">setclass =</span> <span class="st">&quot;tbl_df&quot;</span>)

<span class="co"># Logistic growth</span>
<span class="co"># Same as SPSS syntax: PRED_=K*Yzero/(Yzero + (K-Yzero) * EXP(-1*(r * K * Time))).</span>
log.eq &lt;-<span class="st"> </span>function(Yzero, r, K, Time) {
    K*Yzero/(Yzero +<span class="st"> </span>(K-Yzero) *<span class="st"> </span><span class="kw">exp</span>(-<span class="dv">1</span>*(r *<span class="st"> </span>K *<span class="st"> </span>Time)))
}</code></pre></div>
<p>There is one drawback and you can read about in the help pages:</p>
<blockquote>
<p>Warning</p>
<p>Do not use nls on artificial “zero-residual” data.</p>
</blockquote>
<p>This means, “do not use it on data generated by a deterministic model which has no residual error”, which is exactly what the timeseries in this assignment is, it is the output of the quadratic map in the chaotic regime.</p>
<p>So, this will give an error:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit this function ... gives an error</span>
<span class="co"># The list after &#39;start&#39; provides the initial values</span>
m.log &lt;-<span class="st"> </span><span class="kw">nls</span>(Yt ~<span class="st"> </span><span class="kw">log.eq</span>(Yzero, r, K, Time), <span class="dt">data =</span> df, <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">Yzero=</span>.<span class="dv">01</span>, <span class="dt">r=</span>.<span class="dv">01</span>, <span class="dt">K=</span><span class="dv">1</span>), <span class="dt">trace =</span> T)</code></pre></div>
<p>It is possible to fit these ideal data using package <code>minpack.lm</code>, which contains function <code>nlsM</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(minpack.lm)

m.log &lt;-<span class="st"> </span><span class="kw">nlsLM</span>(Yt ~<span class="st"> </span><span class="kw">log.eq</span>(Yzero, r, K, Time), <span class="dt">data =</span> df, <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">Yzero =</span> .<span class="dv">01</span>, <span class="dt">r=</span>.<span class="dv">01</span>, <span class="dt">K=</span><span class="fl">0.1</span>))

<span class="kw">summary</span>(m.log)</code></pre></div>
<pre><code>
Formula: Yt ~ log.eq(Yzero, r, K, Time)

Parameters:
       Estimate Std. Error t value Pr(&gt;|t|)    
Yzero 7.055e-03  8.983e-05   78.53   &lt;2e-16 ***
r     1.491e-01  4.170e-04  357.59   &lt;2e-16 ***
K     1.002e+00  4.376e-04 2289.42   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.002865 on 97 degrees of freedom

Number of iterations to convergence: 13 
Achieved convergence tolerance: 1.49e-08</code></pre>
<p>In order to look at the model prediction, we use <code>predict()</code> which is defined for almost all modelfitting functions in <code>R</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ypred &lt;-<span class="st"> </span><span class="kw">predict</span>(m.log)

<span class="kw">plot</span>(<span class="kw">ts</span>(df$Yt), <span class="dt">col=</span><span class="st">&quot;gray40&quot;</span>, <span class="dt">lwd=</span><span class="dv">5</span>, <span class="dt">ylab =</span> (<span class="st">&quot;Yt | Ypred&quot;</span>))
<span class="kw">lines</span>(Ypred, <span class="dt">col=</span><span class="st">&quot;gray80&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="DCS1617_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>Then we do a polynomial regression using <code>lm</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Mimic the SPSS syntax</span>
<span class="kw">attach</span>(df)
  df$T1 &lt;-<span class="st"> </span>Yt *<span class="st"> </span>Time
  df$T2 &lt;-<span class="st"> </span>Yt *<span class="st"> </span>(Time^<span class="dv">2</span>) 
  df$T3 &lt;-<span class="st"> </span>Yt *<span class="st"> </span>(Time^<span class="dv">3</span>) 
  df$T4 &lt;-<span class="st"> </span>Yt *<span class="st"> </span>(Time^<span class="dv">4</span>)
<span class="kw">detach</span>(df)

m.poly &lt;-<span class="st"> </span><span class="kw">lm</span>(Yt ~<span class="st"> </span>T1 +<span class="st"> </span>T2 +<span class="st"> </span>T3 +<span class="st"> </span>T4, <span class="dt">data=</span>df)
<span class="kw">summary</span>(m.poly)</code></pre></div>
<pre><code>
Call:
lm(formula = Yt ~ T1 + T2 + T3 + T4, data = df)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0117491 -0.0046800 -0.0000683  0.0045719  0.0112732 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.113e-02  1.258e-03   16.80   &lt;2e-16 ***
T1           6.366e-02  7.169e-04   88.80   &lt;2e-16 ***
T2          -1.497e-03  3.100e-05  -48.28   &lt;2e-16 ***
T3           1.510e-05  4.425e-07   34.12   &lt;2e-16 ***
T4          -5.529e-08  2.055e-09  -26.90   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.005506 on 95 degrees of freedom
Multiple R-squared:  0.9998,    Adjusted R-squared:  0.9998 
F-statistic: 1.264e+05 on 4 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Then, predict and plot!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Ypoly &lt;-<span class="st"> </span><span class="kw">predict</span>(m.poly)

<span class="kw">plot</span>(<span class="kw">ts</span>(Ypoly), <span class="dt">col=</span><span class="st">&quot;blue1&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">ylab =</span> (<span class="st">&quot;Ypoly (blue) | Ypred (red)&quot;</span>))
<span class="kw">lines</span>(Ypred, <span class="dt">col=</span><span class="st">&quot;red1&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="DCS1617_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>SPSS computes an <span class="math inline">\(r^2\)</span> value for nonlinear regression models, which doesn’t make a lot of sense if you think about it. Here we van just compare the residual errors:</p>
<ul>
<li>Polynomial regression: <span class="math inline">\(0.005506\)</span></li>
<li>Analytic solution: <span class="math inline">\(0.002865\)</span>&quot;</li>
</ul>
<p>Slightly less residual error for the analytic solution, using less parameters to fit the model (3 vs. 5). <strong>More important:</strong>, the paramters of the analytic solution have a direct interpretation in terms of growth processes.</p>
<!-- ## Heartbeat dynamics {#hrvsol} -->
<!-- [| jump to assignment |](#hrv) -->
<!-- ```{r, echo=TRUE, eval=TRUE, include=TRUE} -->
<!-- library(rio) -->
<!-- TS1 <- rio::import("https://github.com/FredHasselman/DCS/raw/master/assignmentData/RelativeRoughness/TS1.xlsx", col_names=FALSE) -->
<!-- TS2 <- rio::import("https://github.com/FredHasselman/DCS/raw/master/assignmentData/RelativeRoughness/TS2.xlsx", col_names=FALSE) -->
<!-- TS3 <- rio::import("https://github.com/FredHasselman/DCS/raw/master/assignmentData/RelativeRoughness/TS3.xlsx", col_names=FALSE) -->
<!-- ``` -->
<!-- The Excel files did not have any column names, so let's create them in the `data.frame` -->
<!-- ```{r, eval=TRUE, include=TRUE} -->
<!-- colnames(TS1) <- "TS1" -->
<!-- colnames(TS2) <- "TS2" -->
<!-- colnames(TS3) <- "TS3" -->
<!-- ``` -->
<!-- ```{r, echo=TRUE, include=TRUE, eval=TRUE} -->
<!-- # Create a function for RR -->
<!-- RR <- function(ts){ -->
<!-- # lag.max = n gives autocovariance of lags 0 ... n,  -->
<!-- VAR  <- acf(ts, lag.max = 1, type = 'covariance', plot=FALSE) -->
<!-- # RR formula -->
<!-- RelR   <- 2*(1-VAR$acf[2] / VAR$acf[1]) -->
<!-- # Add some attributes to the output -->
<!-- attributes(RelR) <- list(localAutoCoVariance = VAR$acf[2], globalAutoCoVariance = VAR$acf[1])  -->
<!-- return(RelR) -->
<!-- } -->
<!-- # Look at the results -->
<!-- for(ts in list(TS1,TS2,TS3)){ -->
<!--   relR <- RR(ts[,1]) -->
<!--   cat(paste0(colnames(ts),": RR = ",round(relR,digits=3), " = 2*(1-", -->
<!--          round(attributes(relR)$localAutoCoVariance, digits = 4),"/", -->
<!--          round(attributes(relR)$globalAutoCoVariance,digits = 4),")\n")) -->
<!--   } -->
<!-- ``` -->
<!-- Use Figure \@ref(fig:RRf3) to lookup which value of $RR$ corresponds to which type of noise: -->
<!-- **TS1**: Pink noise -->
<!-- **TS2**: Brownian noise -->
<!-- **TS3**: White noise -->
<!-- ### Randomise -->
<!-- To randomize the data you may use the function `sample` (which is easier than `randperm`) -->
<!-- ```{r} -->
<!-- library(pracma) -->
<!-- # randperm() -->
<!-- TS1Random <- TS1$TS1[randperm(length(TS1$TS1))] -->
<!-- # sample() -->
<!-- TS1Random <- sample(TS1$TS1, length(TS1$TS1)) -->
<!-- plot.ts(TS1Random) -->
<!-- lines(ts(TS1$TS1),col="red3") -->
<!-- ``` -->
<!-- If you repeat this for TS2 and TS3 and compute the Relative Roughness of each randomized time series, the outcomes should be around 2, white noise! This makes sense, you destroyed all the correlations in the data by removing the temporal order with which values were observed. -->
<!-- ### Integrate -->
<!-- Normalize the white noise time series -->
<!-- ```{r} -->
<!-- TS3Norm <- scale(TS3$TS3) -->
<!-- ``` -->
<!-- Now integrate it, which just means, 'take the cumulative sum'. -->
<!-- ```{r} -->
<!-- TS3Int <- cumsum(TS3Norm) -->
<!-- plot.ts(TS3Int) -->
<!-- lines(ts(TS3Norm),col="red3") -->
<!-- ``` -->
<!-- If you compute the Relative Roughness of the integrated time series, the outcome should be close to 0, Brownian noise. -->
<!-- ```{r} -->
<!-- RR(TS3Int) -->
<!-- ``` -->
<!-- # **Fluctuation and Disperion analyses I** {#fda1sol} -->
<!-- ## Assignment: The Spectral Slope {#psdsol} -->
<!-- [| jump to assignment |](#psd) -->
<!-- ```{block2, psd, type='rmdimportant'} -->
<!-- First, load the data and source the function library. -->
<!-- ``` -->
<!-- ```{r, include=FALSE} -->
<!-- library(devtools) -->
<!-- source_url("https://raw.githubusercontent.com/FredHasselman/DCS/master/functionLib/nlRtsa_SOURCE.R") -->
<!-- library(rio) -->
<!-- TS1 <- rio::import("https://raw.githubusercontent.com/FredHasselman/DCS/master/assignmentData/Fluctuation_PSDslope/ts1.txt") -->
<!-- TS2 <- rio::import("https://raw.githubusercontent.com/FredHasselman/DCS/master/assignmentData/Fluctuation_PSDslope/ts2.txt") -->
<!-- TS3 <- rio::import("https://raw.githubusercontent.com/FredHasselman/DCS/master/assignmentData/Fluctuation_PSDslope/ts3.txt") -->
<!-- # These objects are now data.frames with one column named V1.  -->
<!-- # If you want to change the column names -->
<!-- colnames(TS1) <- "TS1" -->
<!-- colnames(TS2) <- "TS2" -->
<!-- colnames(TS3) <- "TS3" -->
<!-- ``` -->
<!-- ### Example of using `--ply` functions {-} -->
<!-- Let's try to use as few commands as possible to analyse all three timeseries. -->
<!-- The easiest way to do this is to use the so-called `apply` family of functions.  -->
<!-- These functions pass the contents of a `list` object to a function. Suppose we need to calculate the means of column variables in 40 different SPSS `.sav` files stored in the folder `DAT`. With the `rio` package loaded we can execute the following commands:  -->
<!-- ```{r, eval=FALSE, tidy=FALSE} -->
<!-- data <- lapply(dir("/DAT/",pattern=".sav$"),import)        -->
<!-- out  <- sapply(data,colMeans) -->
<!-- ``` -->
<!-- The first command *applies* `import` to all files with a `.sav` extension found in the folder `/DAT`. It creates a dataframe for each file which are all stored as elements of the list object `data`. The second line applies the function `colMeans` to each element of `data` and puts the combined results in a matrix with the dataset ID as columns (1-40), dataset variables as rows and the calculated column means as cells. -->
<!-- `R` comes with several `apply` functions installed, but an easier interface is provided by package `plyr`. When `plyr` is loaded you can use functions of the type `XYply` where `X` denotes the first letter of the input structure and `Y` the ouput structure: `l` for `list`, `d` `for 'data.frame`, `a` for `array`. So, `laply()` expects a listobject as input and will try to create an array as outout. There is also a special symbol for `Y`, the underscore `_` if no output is expected, e.g. when plotting, `l_ply`. -->
<!-- ### Data preparation {-} -->
<!-- Let's prepare these series for spectral analysis. -->
<!-- ```{r, message=TRUE, warning=TRUE} -->
<!-- library(plyr) -->
<!-- TSlist <- list(TS1=TS1$TS1,TS2=TS2$TS2,TS3=TS3$TS3) -->
<!-- # Plot raw -->
<!-- l_ply(TSlist, plot.ts) -->
<!-- # Normalise -->
<!-- TSlist.n <- llply(TSlist,scale) -->
<!-- # Plot normalised -->
<!-- l_ply(TSlist.n, plot.ts) -->
<!-- # Detrend -->
<!-- TSlist.nd <- llply(TSlist.n, detrend) -->
<!-- # Plot normalised, detrended -->
<!-- l_ply(TSlist.nd, plot.ts) -->
<!-- ``` -->
<!-- ### Time-series length {-} -->
<!-- Another preparation concerns checking wether the length of the series is a power of 2 (or 10). This is necessary for the Fourier transfrom to run smoothly. The code below uses `log2` and `nextpow2` to figure out whether the data length is ok.  -->
<!-- What is different from previous uses of the `XYply` functions is that we now customise the function we want to execute. The input is still a list object, each element of the list is passed as a variable `ts` to a so-called `anonymous` function, a function just denoted as `function(ts)`. The function returns a data.frame with columns `pow2`, the current power of 2 and `nextpow2` (a function of `pracma`) the next power of 2.  -->
<!-- The `XYply` functions will add an `.id` variable to the output if the input is a list with named fields. Although we create 3 data frames of one row, the `d` in `ldply` indicates these frames have to be merged if possible.   -->
<!-- ```{r} -->
<!-- ldply(TSlist.nd, function(ts) data.frame(pow2 = log2(length(ts)), nextpow2 = nextpow2(length(ts)))) -->
<!-- ``` -->
<!-- * In this case we don't have to take any action, $2048$ is a power of 2.  -->
<!-- * Actions that could be taken are: removing datapoints from the front of the series, or, padding the series with zeroes. -->
<!-- ### The `fd.psd` function {-} -->
<!-- The function created for spectral analysis `fd.psd()` will perform normalisation and detrending by default. It also returns information about the power spectrum and log-log fit. It's good to know about the default settings of a function, and the return values. The best place to look for them is usually the `help` documentation, or the `vignettes` that come with a package. -->
<!-- If you select a function in `Rstudio` and press `F1` you'll get the help page, If you press `F2` can have a look at the code (if it is `exported`), or, you can call the function without parentheses `fd.psd` and the code will be printed to the Console. -->
<!-- You can also hover the cursor after you typed the name of the function to reveal the arguments and defaults:  -->
<!-- ```{r fig.align='center', fig.cap= 'Get default values of function arguments.', echo=FALSE, include=identical(knitr:::pandoc_to(), 'html')} -->
<!-- knitr::include_graphics('images/scr.png', dpi = NA) -->
<!-- ``` -->
<!-- Another way to get this info is to use the function `formals()` -->
<!-- ```{r, message=FALSE, warning=FALSE} -->
<!-- formals(fd.psd) -->
<!-- ``` -->
<!-- Now we know this function has arguments `normalize` and `dtrend` set to `TRUE`, and `plot` set to `FALSE`. We could feed the fuction the raw data, or feed it our normalised, detrended, data and change the defaults. In the `XYply` functions, you can just add function arguments after the function name. -->
<!-- ```{r, fig.height=12, message=FALSE, warning=FALSE} -->
<!-- # Analyse -->
<!-- outPSD <- llply(TSlist.nd, fd.psd, normalize = FALSE, dtrend = FALSE, plot=TRUE) -->
<!-- ``` -->
<!-- # **Fluctuation and Disperion analyses II** {#fda1so2} -->
<!-- There were no assignments for this Lecture. -->
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="pacfsol.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="phase-space-reconstruction-and-recurrence-quantification-analysis-rqa.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true,
"toc": null
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
